# 需求文档

## 简介

本功能旨在为基于 VuePress 的 Obsidian 文档网站新增一个插件展示栏目。该栏目将从 Obsidian 官方 API 自动获取插件信息,并以多种视图模式展示给用户,支持搜索、筛选和排序功能。由于项目部署在 Netlify 免费版(无数据库),所有数据将以静态 JSON 文件形式存储,通过 GitHub Actions 定时更新。

## 需求

### 需求 1: 数据获取与自动更新

**用户故事:** 作为网站维护者,我希望系统能够自动从 Obsidian 官方 API 获取最新的插件信息,这样用户就能看到最新的插件数据而无需手动更新。

#### 验收标准

1. WHEN 系统运行数据获取任务 THEN 系统 SHALL 从 Obsidian 官方的 2 个 API 端点获取插件数据
2. WHEN 获取到插件数据 THEN 系统 SHALL 整合两个端点的数据并包含以下字段:插件名称、描述、作者、下载数量、更新日期、版本号、插件 ID、仓库地址
3. WHEN 数据整合完成 THEN 系统 SHALL 将数据保存为静态 JSON 文件到 `docs/src/.vuepress/public/data/plugins.json`
4. WHEN GitHub Actions 工作流被触发 THEN 系统 SHALL 自动执行数据拉取脚本
5. IF 数据拉取成功 THEN 系统 SHALL 自动提交更新后的 JSON 文件到 Git 仓库
6. WHEN 配置定时任务 THEN 系统 SHALL 每天自动执行一次数据更新(UTC 时间 00:00)
7. IF API 请求失败 THEN 系统 SHALL 记录错误日志并保留上一次成功获取的数据

### 需求 2: 插件列表页面布局

**用户故事:** 作为用户,我希望插件展示页面能够保持网站的整体风格,并且在不同主题模式下都能正常显示,这样我就能获得一致的浏览体验。

#### 验收标准

1. WHEN 用户访问插件展示页面 THEN 页面 SHALL 保留网站现有的头部(header)和底部(footer)组件
2. WHEN 页面渲染 THEN 正文区域 SHALL 使用全宽自适应布局
3. WHEN 用户切换深色/浅色主题 THEN 插件展示页面 SHALL 完全兼容主题切换并正确显示所有元素
4. WHEN 页面加载 THEN 所有样式 SHALL 不影响网站其他页面的布局和样式
5. WHEN 在移动设备上访问 THEN 页面 SHALL 采用响应式设计并正确显示所有功能
6. WHEN 在桌面设备上访问 THEN 页面 SHALL 充分利用屏幕宽度展示内容

### 需求 3: 视图模式切换

**用户故事:** 作为用户,我希望能够以不同的视图模式浏览插件列表,这样我就能根据自己的偏好选择最合适的展示方式。

#### 验收标准

1. WHEN 用户访问插件列表页面 THEN 系统 SHALL 提供三种视图模式:卡片视图、列表视图、紧凑视图
2. WHEN 用户选择卡片视图 THEN 系统 SHALL 以卡片形式展示插件,包含插件图标、名称、描述、作者、下载量等信息
3. WHEN 用户选择列表视图 THEN 系统 SHALL 以表格形式展示插件的详细信息
4. WHEN 用户选择紧凑视图 THEN 系统 SHALL 以纯文字紧凑列表形式展示插件名称和基本信息
5. WHEN 用户切换视图模式 THEN 系统 SHALL 保存用户的选择到浏览器本地存储
6. WHEN 用户再次访问页面 THEN 系统 SHALL 自动加载用户上次选择的视图模式
7. WHEN 视图模式切换 THEN 当前的筛选、搜索和排序状态 SHALL 保持不变

### 需求 4: 搜索功能

**用户故事:** 作为用户,我希望能够快速搜索插件,这样我就能快速找到我需要的插件而不用浏览整个列表。

#### 验收标准

1. WHEN 用户在搜索框输入关键词 THEN 系统 SHALL 实时过滤插件列表
2. WHEN 执行搜索 THEN 系统 SHALL 在插件名称、描述、作者字段中进行匹配
3. WHEN 搜索匹配成功 THEN 系统 SHALL 高亮显示匹配的关键词
4. WHEN 搜索框为空 THEN 系统 SHALL 显示所有插件
5. IF 搜索无结果 THEN 系统 SHALL 显示友好的"未找到匹配插件"提示信息
6. WHEN 用户清空搜索框 THEN 系统 SHALL 恢复显示完整的插件列表
7. WHEN 搜索进行中 THEN 系统 SHALL 显示搜索结果数量

### 需求 5: 筛选与排序功能

**用户故事:** 作为用户,我希望能够按照不同的条件筛选和排序插件,这样我就能更容易找到符合我需求的插件。

#### 验收标准

1. WHEN 用户访问插件列表 THEN 系统 SHALL 提供按分类、下载量范围、更新时间范围的筛选选项
2. WHEN 用户选择筛选条件 THEN 系统 SHALL 只显示符合所有筛选条件的插件
3. WHEN 用户应用多个筛选条件 THEN 系统 SHALL 使用 AND 逻辑组合所有条件
4. WHEN 用户点击排序选项 THEN 系统 SHALL 提供按下载量、更新时间、名称(字母顺序)的排序方式
5. WHEN 选择排序方式 THEN 系统 SHALL 支持升序和降序两种排序方向
6. WHEN 筛选或排序改变 THEN 系统 SHALL 保持当前的搜索关键词和视图模式
7. WHEN 用户清除所有筛选条件 THEN 系统 SHALL 显示完整的插件列表
8. WHEN 筛选或排序后 THEN 系统 SHALL 显示当前显示的插件数量和总数量

### 需求 6: 分页与导航

**用户故事:** 作为用户,我希望插件列表能够分页显示,这样页面加载速度更快,浏览体验更好。

#### 验收标准

1. WHEN 插件列表加载 THEN 系统 SHALL 默认每页显示 20 个插件
2. WHEN 用户访问页面 THEN 系统 SHALL 提供每页显示数量的选项(10、20、50、100)
3. WHEN 用户更改每页显示数量 THEN 系统 SHALL 重新计算分页并跳转到第一页
4. WHEN 用户浏览列表 THEN 系统 SHALL 在页面底部显示分页导航组件
5. WHEN 用户点击页码 THEN 系统 SHALL 跳转到对应页面并滚动到列表顶部
6. WHEN 用户使用键盘左右方向键 THEN 系统 SHALL 分别切换到上一页和下一页
7. WHEN 用户滚动到页面底部 THEN 系统 SHALL 显示"返回顶部"按钮
8. WHEN 用户点击"返回顶部"按钮 THEN 页面 SHALL 平滑滚动到顶部
9. IF 用户在最后一页按右方向键 THEN 系统 SHALL 保持在当前页
10. IF 用户在第一页按左方向键 THEN 系统 SHALL 保持在当前页

### 需求 7: 插件详情页面

**用户故事:** 作为用户,我希望每个插件都有独立的详情页面,这样我就能深入了解插件的功能、查看教程文档,并获得相关的社区支持信息。

#### 验收标准

1. WHEN 数据更新脚本运行 THEN 系统 SHALL 为每个插件自动生成独立的 Markdown 详情页面
2. WHEN 生成详情页面 THEN 页面路径 SHALL 遵循 `/zh/plugins/[plugin-id].md` 格式
3. WHEN 用户点击插件卡片或列表项 THEN 系统 SHALL 导航到该插件的独立详情页面
4. WHEN 显示插件详情 THEN 页面 SHALL 包含插件名称、完整描述、作者信息、版本号、下载量、更新日期、仓库链接
5. WHEN 插件有 README 内容 THEN 系统 SHALL 显示格式化的 README 内容
6. WHEN 详情页面渲染 THEN 系统 SHALL 预留教程文档区域,显示"教程文档即将推出"的占位内容
7. WHEN 详情页面加载 THEN 系统 SHALL 在侧边栏或底部显示统一的广告位组件
8. WHEN 显示广告位 THEN 系统 SHALL 默认显示加群引导信息(可通过配置文件统一修改)
9. WHEN 用户在详情页面 THEN 系统 SHALL 提供"在 GitHub 上查看"、"返回列表"、"相关插件推荐"的操作按钮
10. WHEN 新插件被添加到数据源 THEN 系统 SHALL 在下次数据更新时自动生成对应的详情页面
11. WHEN 插件被删除或下架 THEN 系统 SHALL 在下次数据更新时自动删除对应的详情页面
12. WHEN 详情页面生成 THEN 系统 SHALL 使用统一的模板确保所有页面风格一致

### 需求 8: 性能与用户体验

**用户故事:** 作为用户,我希望插件展示页面加载快速且操作流畅,这样我就能获得良好的使用体验。

#### 验收标准

1. WHEN 页面首次加载 THEN 系统 SHALL 在 2 秒内完成初始渲染
2. WHEN 用户进行搜索、筛选、排序操作 THEN 系统 SHALL 在 300 毫秒内响应
3. WHEN 数据量较大时 THEN 系统 SHALL 使用虚拟滚动或分页来优化性能
4. WHEN 用户切换视图模式 THEN 系统 SHALL 平滑过渡无闪烁
5. WHEN 加载插件数据 THEN 系统 SHALL 显示加载状态指示器
6. IF 数据加载失败 THEN 系统 SHALL 显示友好的错误提示并提供重试选项
7. WHEN 用户操作时 THEN 所有交互 SHALL 提供视觉反馈(如按钮悬停效果、点击效果)

### 需求 9: 代码质量与可维护性

**用户故事:** 作为开发者,我希望代码结构清晰、模块化且易于维护,这样未来的功能扩展和维护工作会更加容易。

#### 验收标准

1. WHEN 开发新功能 THEN 代码 SHALL 采用模块化、组件化的开发方式
2. WHEN 编写代码 THEN 所有代码注释 SHALL 使用中文
3. WHEN 创建组件 THEN 组件 SHALL 遵循单一职责原则,功能尽量拆分
4. WHEN 编写函数 THEN 可复用的函数 SHALL 提取为独立的工具函数
5. WHEN 添加新功能 THEN 代码 SHALL 与现有 VuePress 配置和主题完全兼容
6. WHEN 修改样式 THEN 样式 SHALL 使用 scoped 或 CSS Modules 避免全局污染
7. WHEN 处理数据 THEN 数据处理逻辑 SHALL 与 UI 组件分离
8. WHEN 编写脚本 THEN 脚本 SHALL 包含错误处理和日志记录

### 需求 10: 数据统计与排行榜

**用户故事:** 作为用户,我希望能够看到有趣的插件统计数据和排行榜,这样我就能发现热门和趋势插件,增加浏览的趣味性。

#### 验收标准

1. WHEN 用户访问插件列表页面 THEN 系统 SHALL 在顶部显示统计数据面板
2. WHEN 显示统计面板 THEN 系统 SHALL 包含总插件数量、本周新增插件数、总下载量等关键指标
3. WHEN 用户查看排行榜 THEN 系统 SHALL 提供"每周热门"、"当月热门"、"总下载排行"三个排行榜标签
4. WHEN 显示"每周热门"排行榜 THEN 系统 SHALL 根据最近 7 天的下载增长量排序显示前 10 名插件
5. WHEN 显示"当月热门"排行榜 THEN 系统 SHALL 根据最近 30 天的下载增长量排序显示前 10 名插件
6. WHEN 显示"总下载排行"榜 THEN 系统 SHALL 根据总下载量排序显示前 10 名插件
7. WHEN 排行榜数据更新 THEN 系统 SHALL 在每次 GitHub Actions 运行时重新计算排行榜数据
8. WHEN 显示排行榜项目 THEN 系统 SHALL 显示排名、插件名称、下载量、增长趋势图标
9. WHEN 用户点击排行榜中的插件 THEN 系统 SHALL 导航到该插件的详情页面
10. WHEN 排行榜渲染 THEN 系统 SHALL 使用图表或可视化组件增强展示效果

### 需求 11: 广告位管理系统

**用户故事:** 作为网站管理员,我希望能够统一管理所有页面的广告位内容,这样我只需要在一个地方修改,所有页面的广告内容就会同步更新。

#### 验收标准

1. WHEN 系统初始化 THEN 系统 SHALL 创建统一的广告位配置文件 `docs/src/.vuepress/config/ads.ts`
2. WHEN 配置广告位 THEN 配置文件 SHALL 支持定义多个广告位(如侧边栏广告、底部广告、详情页广告)
3. WHEN 定义广告内容 THEN 系统 SHALL 支持 HTML、Markdown 和 Vue 组件三种格式
4. WHEN 插件详情页面渲染 THEN 系统 SHALL 自动加载并显示配置的广告位组件
5. WHEN 广告位配置更新 THEN 所有使用该广告位的页面 SHALL 自动同步更新内容
6. WHEN 显示默认广告 THEN 系统 SHALL 显示加群引导信息(包含二维码、群号、引导文案)
7. WHEN 管理员修改广告配置 THEN 系统 SHALL 在下次构建时应用新的广告内容
8. WHEN 广告位组件加载 THEN 系统 SHALL 保持与页面主题的样式一致性
9. WHEN 在移动端显示 THEN 广告位 SHALL 自动调整布局以适应小屏幕

### 需求 12: 自动化页面生成与同步

**用户故事:** 作为网站维护者,我希望当插件数据更新时,系统能够自动生成、更新或删除对应的详情页面,这样即使是静态网站也能保持内容的同步性。

#### 验收标准

1. WHEN GitHub Actions 数据更新任务运行 THEN 系统 SHALL 执行页面生成脚本
2. WHEN 检测到新插件 THEN 系统 SHALL 基于模板自动生成新的插件详情页面
3. WHEN 插件信息更新 THEN 系统 SHALL 更新对应详情页面的内容
4. WHEN 插件被删除或下架 THEN 系统 SHALL 自动删除对应的详情页面文件
5. WHEN 生成详情页面 THEN 系统 SHALL 使用统一的 Markdown 模板文件
6. WHEN 模板包含变量 THEN 系统 SHALL 自动替换为插件的实际数据(名称、描述、作者等)
7. WHEN 页面生成完成 THEN 系统 SHALL 自动提交所有变更到 Git 仓库
8. WHEN 提交到 Git THEN 系统 SHALL 触发 Netlify 自动部署
9. WHEN 生成过程出错 THEN 系统 SHALL 记录详细错误日志并发送通知
10. WHEN 页面生成脚本运行 THEN 系统 SHALL 生成页面索引文件以优化导航和搜索

### 需求 13: 兼容性与响应式设计

**用户故事:** 作为用户,我希望无论使用什么设备或浏览器访问,都能正常使用插件展示功能,这样我就能在任何环境下浏览插件信息。

#### 验收标准

1. WHEN 在移动设备上访问 THEN 页面 SHALL 自动适配屏幕尺寸
2. WHEN 在平板设备上访问 THEN 页面 SHALL 优化布局以适应中等屏幕
3. WHEN 在桌面设备上访问 THEN 页面 SHALL 充分利用大屏幕空间
4. WHEN 在不同浏览器中访问 THEN 页面 SHALL 在 Chrome、Firefox、Safari、Edge 最新版本中正常工作
5. WHEN 屏幕宽度小于 768px THEN 系统 SHALL 自动切换到移动端布局
6. WHEN 在移动端 THEN 筛选和排序选项 SHALL 以抽屉或下拉菜单形式展示
7. WHEN 在移动端 THEN 卡片视图 SHALL 自动调整为单列布局
8. WHEN 在移动端查看详情页 THEN 广告位 SHALL 自动调整为适合小屏幕的布局
